<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Lucky Draw</title>

<style>
:root{
  --primary-color:#003A8F;
  --secondary-color:#1890FF;
  --accent-color:#FADB14;
  --win-red:#d4380d;
}

body{
  font-family:"Segoe UI",Arial,sans-serif;
  background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));
  margin:0;
}

/* ‚úÖ ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ */
.container{
  width:100%;
  max-width:none;
  margin:0;
  background:#fff;
  border-radius:0;
  padding:28px 20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.16);
  text-align:center;
}

.logo img{ max-height:110px; margin:10px 0 10px; }

h1{ margin:0; color:var(--primary-color); }
.subtitle{ margin:10px 0 18px; color:#666; }

/* Controls */
.controls{
  display:flex;
  gap:10px;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
  margin:10px 0 8px;
}
select{
  font-size:16px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(0,0,0,0.15);
  min-width:360px;
  max-width:92vw;
}
button{
  font-size:18px;
  padding:12px 22px;
  border-radius:999px;
  border:none;
  cursor:pointer;
  background:var(--primary-color);
  color:#fff;
  display:inline-flex;
  align-items:center;
  gap:8px;
}
button:disabled{ background:#aaa; cursor:not-allowed; }

/* Pills */
.stage{
  margin:10px auto 0;
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  max-width:1200px;
}
.pill{
  padding:8px 12px;
  border-radius:999px;
  background:#f2f4f7;
  color:#333;
  font-size:14px;
  border:1px solid rgba(0,0,0,0.06);
}
.pill.done{
  background:rgba(0,0,0,.05);
  color:#777;
  text-decoration:line-through;
}
.pill.active{
  background:rgba(24,144,255,.12);
  border-color:rgba(24,144,255,.35);
  color:var(--primary-color);
  font-weight:800;
}

/* Countdown + Animation */
.animation-box{
  margin:14px auto 0;
  padding:22px;
  border-radius:18px;
  background:#f0f5ff;
  min-height:160px;
  display:none;
  flex-direction:column;
  justify-content:center;
  gap:10px;
  max-width:1200px;
}
.countdown{
  font-size:56px;
  font-weight:1100;
  color:var(--win-red);
  line-height:1;
}
.spintext{
  font-size:22px;
  font-weight:900;
  color:var(--primary-color);
}
.spinner{ animation:pulse 1s infinite; }
@keyframes pulse{
  0%{opacity:.35} 50%{opacity:1} 100%{opacity:.35}
}

/* ‚úÖ Result layout: centered area but full-row cards span across */
.grid{
  margin-top:18px;
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
  text-align:left;

  width:100%;
  max-width:1200px;
  margin-left:auto;
  margin-right:auto;
}
@media (min-width: 1000px){
  .grid{ grid-template-columns:1fr 1fr; align-items:start; }
}

/* ‚úÖ ‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡πà‡∏≠‡∏á "‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏ô‡∏ß" ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á */
.big-winner,
.batch-results{
  grid-column: 1 / -1;
  width:100%;
  justify-self:center;
}

/* Big prizes 1‚Äì3 */
.big-winner{
  display:none;
  border-radius:18px;
  padding:20px;
  background:radial-gradient(circle at top left, rgba(250,219,20,.60), rgba(24,144,255,.10) 55%, #fff 100%);
  border:3px solid var(--accent-color);
  box-shadow:0 14px 34px rgba(0,0,0,.18);
  position:relative;
  overflow:hidden;
}
.big-winner::after{
  content:"";
  position:absolute;
  top:-70px; right:-70px;
  width:190px; height:190px;
  background:rgba(250,219,20,.33);
  border-radius:50%;
  filter:blur(2px);
}
.big-winner h2{
  margin:0 0 12px;
  color:var(--primary-color);
  font-size:28px;
  font-weight:1100;
  display:flex;
  align-items:center;
  gap:10px;
}
.big-card{
  background:#fff;
  border-radius:16px;
  padding:18px;
  border:1px solid rgba(0,0,0,.10);
}
.big-title{ font-weight:1100; font-size:20px; color:var(--primary-color); }
.big-amount{ font-weight:1100; font-size:28px; color:var(--win-red); margin-top:6px; }
.big-name{ margin-top:10px; font-size:30px; font-weight:1200; color:#111; line-height:1.25; }

/* Batch prizes 4‚Äì5 (3‚Äì4 columns, centered cards) */
.batch-results{
  display:none;
  background:#fafafa;
  border-radius:16px;
  padding:18px;
  border:1px solid rgba(0,0,0,0.06);
}
.batch-results h3{ margin:0 0 12px; color:var(--primary-color); }

.batch-grid{
  list-style:none;
  margin:0;
  padding:0;
  display:grid;
  gap:10px 16px;
  grid-template-columns:1fr;     /* mobile */
  justify-items:center;           /* ‚úÖ ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á */
}
@media (min-width: 600px){
  .batch-grid{ grid-template-columns:repeat(3, minmax(0, 1fr)); } /* ‚úÖ 3 cols */
}
@media (min-width: 1200px){
  .batch-grid{ grid-template-columns:repeat(4, minmax(0, 1fr)); } /* ‚úÖ 4 cols */
}
.batch-item{
  width:100%;
  max-width:320px;
  background:#fff;
  border:1px solid rgba(0,0,0,0.08);
  border-radius:12px;
  padding:10px 12px;
  font-weight:750;
  font-size:14px;
}

/* Final summary */
.final-summary{
  display:none;
  margin:18px auto 0;
  text-align:left;
  background:#ffffff;
  border-radius:16px;
  padding:18px;
  border:1px solid rgba(0,0,0,0.08);
  width:100%;
  max-width:1400px;
}
.final-summary h2{ margin:0 0 10px; color:var(--primary-color); }
.final-top3{
  display:grid;
  grid-template-columns:1fr;
  gap:12px;
  margin:10px 0 14px;
}
@media (min-width: 900px){
  .final-top3{ grid-template-columns: 1fr 1fr 1fr; }
}
.top3-card{
  border-radius:16px;
  padding:16px;
  background:radial-gradient(circle at top left, rgba(250,219,20,.60), rgba(24,144,255,.06) 60%, #fff 100%);
  border:2px solid var(--accent-color);
  box-shadow:0 10px 26px rgba(0,0,0,.14);
}
.top3-rank{
  font-size:30px;
  font-weight:1200;
  color:var(--primary-color);
  display:flex;
  align-items:center;
  gap:10px;
}
.top3-prize{ margin-top:6px; font-size:18px; font-weight:1100; color:var(--primary-color); }
.top3-amount{ margin-top:4px; font-size:24px; font-weight:1200; color:var(--win-red); }
.top3-winner{ margin-top:10px; font-size:22px; font-weight:1200; color:#111; line-height:1.25; }
.final-rest h4{ margin:14px 0 8px; color:#333; }
.final-rest ul{ margin:0; padding-left:18px; }
.final-rest li{ margin-bottom:6px; }

/* Actions */
.actions{
  display:none;
  margin:14px auto 0;
  justify-content:center;
  gap:10px;
  max-width:1200px;
}
.actions button.neutral{ background:#444; }
.actions button.secondary{ background:#2f54eb; }
.actions button{ background:var(--secondary-color); }

/* Print */
@media print{
  body{ background:#fff; }
  .controls,.stage,.animation-box,.actions{ display:none !important; }
  .container{ box-shadow:none; margin:0; border-radius:0; }
}

.footer-note{ margin:14px auto 0; color:#777; font-size:13px; max-width:1600px; }
</style>
</head>

<body>
<div class="container" id="printArea">
  <div class="logo">
    <img src="logo.png" alt="Company Logo">
  </div>

  <h1>üéâ Lucky Draw 2025 üéâ</h1>
  <div class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ ‚Ä¢ Countdown 10‚Üí1 ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏â‡∏•‡∏¢‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>

  <div class="controls">
    <select id="prizeSelect"></select>
    <button id="drawBtn">üéÅ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
  </div>

  <div class="stage" id="stagePills"></div>

  <div class="animation-box spinner" id="animationBox">
    <div class="countdown" id="countdown">10</div>
    <div class="spintext" id="spinText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°...</div>
  </div>

  <div class="grid">
    <div class="big-winner" id="bigWinnerBox">
      <h2 id="bigTitle">üèÜ ‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏´‡∏ç‡πà</h2>
      <div class="big-card" id="bigCard"></div>
    </div>

    <div class="batch-results" id="batchResults">
      <h3 id="batchTitle">üìã ‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
      <ol class="batch-grid" id="batchList"></ol>
    </div>
  </div>

  <div class="final-summary" id="finalSummary">
    <h2>‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
    <div id="finalContent"></div>
  </div>

  <div class="actions" id="actions">
    <button class="neutral" id="printBtn">üñ®Ô∏è Print</button>
    <button class="secondary" id="exportBtn">üìÑ Export Excel (CSV)</button>
  </div>

  <div class="footer-note" id="remainNote"></div>
</div>

<script>
// ‚úÖ ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (pool)
let pool = [
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏•‡∏¥‡∏ô ‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏ò‡∏¥‡∏û‡∏à‡∏ô‡πå ‡∏™‡∏≤‡∏°‡∏á‡∏≤‡∏°‡∏ô‡∏∏ (Messenger)",
"‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏≤‡∏•‡πå‡∏° ‡∏ô‡∏≤‡∏¢‡∏ö‡∏∏‡∏ç‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡πå ‡∏°‡∏≤‡∏•‡∏≤‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå (Messenger)",
"‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏≠‡∏ô ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏≠‡∏ô ‡πÇ‡∏Ñ‡∏ô‡∏à‡∏ß‡∏á (Maid)",
"‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏à‡πä‡∏Ñ ‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏£‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å (Messenger)",
"‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏Å‡πâ‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏ß‡∏¥‡∏ô‡∏ó‡∏∞‡πÑ‡∏ä‡∏¢ (Maid)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ê‡∏≤‡∏ô‡∏¥‡∏ï‡∏≤ ‡∏Å‡∏π‡∏î‡∏≠‡∏±‡πâ‡∏ß (Assistant Billing Manager)",
"‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏¥‡πä‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏£‡∏£‡∏ì‡∏û‡∏£ ‡∏à‡∏£‡∏π‡∏ç‡∏£‡∏±‡∏ï‡∏ô‡πå (Senior Billing Executive)",
"‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ç‡∏¥‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏ß‡∏î‡∏µ ‡∏û‡∏•‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (Billing Executive)",
"‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏®‡∏°‡∏±‡∏¢ ‡∏®‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå (Billing Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡∏• ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏µ‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏®‡∏¥‡∏£‡∏¥‡∏©‡∏≤ (Billing Executive)",
"‡∏Ñ‡∏∏‡∏ì‡∏°‡∏¥‡∏•‡∏Ñ‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏°‡∏ú‡∏Å‡∏≤ ‡∏õ‡∏ß‡∏á‡∏á‡∏≤‡∏° (Finance Executive - Payable)",
"‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö‡∏ß‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏ê‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡∏ö‡∏∂‡∏Å‡∏ô‡∏±‡∏ô‡∏ï‡∏≤ (Billing Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏ê‡∏ß‡∏£‡∏£‡∏ì ‡∏™‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (Finance Executive - Payable)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡∏°‡∏µ‡πà‡∏¢‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏µ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏û‡∏≤ (Senior Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠‡πä‡∏ï ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏¥‡∏ï‡∏¢‡∏≤ ‡πÑ‡∏ï‡∏£‡∏û‡∏£‡∏° (Assistant Customs Broker Manager)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏Ü ‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏™‡∏∏‡∏Ç‡∏•‡∏¥‡πâ‡∏° (Shipping Executive)",
"‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏ô ‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡πÇ‡∏ä‡∏ï‡∏¥ ‡πÄ‡∏•‡πá‡∏Å‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏¥‡∏á (Shipping Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡∏£‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏ß‡∏ì‡∏µ‡∏¢‡πå ‡πÄ‡∏û‡πá‡∏ä‡∏£‡∏Ñ‡∏£‡∏∏‡∏ò (Senior Customs Broker Executive - Export)",
"‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏≠ ‡∏ô‡∏≤‡∏¢‡∏ò‡∏ß‡∏±‡∏ä‡∏ä‡∏±‡∏¢ ‡∏†‡∏≤‡∏ô‡∏∏‡∏û‡∏±‡∏ô‡∏ò‡πå (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡∏à‡πã‡∏≤ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏à‡∏∏‡∏ë‡∏≤‡∏°‡∏≤‡∏® ‡πÄ‡∏≠‡∏¥‡∏ö‡∏™‡∏≥‡πÇ‡∏£‡∏á (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏∏‡πà‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏ô ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏¢‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏ô‡∏Å‡∏ß‡∏£‡∏£‡∏ì ‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå (Customs Broker Executive - Export)",
"‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏£‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏¥‡∏£‡∏¥‡∏û‡∏£ ‡πÅ‡∏û‡πÑ‡∏ò‡∏™‡∏á (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ú‡∏Å‡∏≤‡∏ß‡∏î‡∏µ ‡πÇ‡∏Å‡∏®‡∏¥‡∏£‡∏¥ (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏°‡∏û‡∏π ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡∏∏‡∏ä ‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏µ‡∏¢‡∏° (Customs Broker Executive - Export)",
"‡∏Ñ‡∏∏‡∏ìBen ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏∏‡∏†‡∏£‡∏≤ ‡∏ò‡∏ô‡∏≤‡∏®‡∏¥‡∏£‡∏¥‡πÄ‡∏à‡∏£‡∏¥‡∏ç (Customs Broker Executive - Import)",
"‡∏Ñ‡∏∏‡∏ì‡∏ü‡∏¥‡∏ß‡∏™‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏∏‡∏†‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏Ç‡∏¢‡∏±‡∏ô‡∏ó‡∏≥ (Senior People Operations Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡πã ‡∏ô‡∏≤‡∏¢‡∏à‡∏¥‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏Ñ‡∏π‡∏´‡∏∞‡∏°‡∏ì‡∏µ (Safety Manager)",
"‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏∏‡πã‡∏° ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏•‡∏¥‡∏©‡∏≤ ‡∏™‡∏°‡∏≠‡πà‡∏≠‡∏ô (Assistant Transportation Manager)",
"‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡πá‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏¢‡∏∏‡∏£‡∏µ‡∏¢‡πå ‡∏Å‡∏±‡∏ô‡πÉ‡∏à (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡∏î ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏†‡∏≤ ‡∏™‡∏≤‡∏£‡∏µ‡∏ö‡∏∏‡∏ï‡∏£ (Senior CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏ö‡πÄ‡∏ä‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡∏≤ ‡∏Ñ‡∏á‡πÑ‡∏ó‡∏¢ (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏¥‡πâ‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏∏‡∏•‡∏ì‡∏±‡∏ê ‡∏ö‡∏∏‡∏ö‡∏ú‡∏≤‡πÇ‡∏†‡∏ä‡∏ô‡πå (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏≤ ‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏™‡∏≤ (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏£‡∏£‡∏ì ‡∏≠‡∏¥‡∏ô‡∏ô‡∏±‡∏ô‡∏ä‡∏±‡∏¢ (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏£‡∏™‡∏∏‡∏†‡∏≤ ‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏£‡∏´‡∏° (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏ô‡πâ‡∏≠‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏é‡∏ê‡πå‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏û‡∏≤‡πÅ‡∏Å‡πâ‡∏ß (CS Executive - Transportation)",
"‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏∏ ‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏©‡πå ‡∏†‡∏≤‡∏©‡∏µ‡∏î‡∏≤ (Transportation Maintenance Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡πá‡∏î ‡∏ô‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏î‡∏∏‡∏ô‡∏≤ (Transportation Maintenance Executive)",
"‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ô‡∏∏‡πà‡∏° ‡∏ô‡∏≤‡∏¢‡∏ô‡∏±‡∏ó‡∏ò‡∏µ ‡∏ö‡∏∏‡∏ç‡∏õ‡∏≤‡∏ô (Transportation Maintenance Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏Å ‡∏ô‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏ä‡∏±‡∏¢ ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô (Transportation Maintenance Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠‡πä‡∏ï ‡∏ô‡∏≤‡∏¢‡∏ß‡∏±‡∏ä‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏î‡∏∏‡∏ô‡∏≤ (Transportation Maintenance Executive)",
"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏™‡∏Å ‡∏ô‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏ß‡∏±‡∏ä ‡πÄ‡∏û‡πá‡∏ä‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå (Transportation Maintenance Executive)"
];

// ‚úÖ ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
const prizes = [
  { id:"p1", label:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1 (5,000 ‡∏ö‡∏≤‡∏ó) x1", prizeName:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1", amount:5000, count:1, mode:"single", rank:1 },
  { id:"p2", label:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 2 (3,000 ‡∏ö‡∏≤‡∏ó) x1", prizeName:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 2", amount:3000, count:1, mode:"single", rank:2 },
  { id:"p3", label:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3 (2,000 ‡∏ö‡∏≤‡∏ó) x1", prizeName:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3", amount:2000, count:1, mode:"single", rank:3 },
  { id:"p4", label:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 4 (1,000 ‡∏ö‡∏≤‡∏ó) x20", prizeName:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 4", amount:1000, count:20, mode:"batch" },
  { id:"p5", label:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 5 (500 ‡∏ö‡∏≤‡∏ó) x20",  prizeName:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 5", amount:500,  count:20, mode:"batch" }
];

// ‚úÖ ‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏•‡∏ï‡∏≤‡∏° CSV (100%)
const LOCKED_RESULTS = {
  p1: ["‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏¥‡πâ‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏∏‡∏•‡∏ì‡∏±‡∏ê ‡∏ö‡∏∏‡∏ö‡∏ú‡∏≤‡πÇ‡∏†‡∏ä‡∏ô‡πå (CS Executive - Transportation)"],
  p2: ["‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏ô ‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡πÇ‡∏ä‡∏ï‡∏¥ ‡πÄ‡∏•‡πá‡∏Å‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏¥‡∏á (Shipping Executive)"],
  p3: ["‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡πá‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏¢‡∏∏‡∏£‡∏µ‡∏¢‡πå ‡∏Å‡∏±‡∏ô‡πÉ‡∏à (CS Executive - Transportation)"],
  p4: [
    "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏à‡πä‡∏Ñ ‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏£‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏£‡∏∞‡πÇ‡∏ó‡∏Å (Messenger)",
    "‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ç‡∏¥‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏ß‡∏î‡∏µ ‡∏û‡∏•‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (Billing Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏Å‡πâ‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏£‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏ß‡∏¥‡∏ô‡∏ó‡∏∞‡πÑ‡∏ä‡∏¢ (Maid)",
    "‡∏Ñ‡∏∏‡∏ìBen ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏∏‡∏†‡∏£‡∏≤ ‡∏ò‡∏ô‡∏≤‡∏®‡∏¥‡∏£‡∏¥‡πÄ‡∏à‡∏£‡∏¥‡∏ç (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ü‡∏¥‡∏ß‡∏™‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏∏‡∏†‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏Ç‡∏¢‡∏±‡∏ô‡∏ó‡∏≥ (Senior People Operations Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏°‡∏û‡∏π ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡∏∏‡∏ä ‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏µ‡∏¢‡∏° (Customs Broker Executive - Export)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏£‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏¥‡∏£‡∏¥‡∏û‡∏£ ‡πÅ‡∏û‡πÑ‡∏ò‡∏™‡∏á (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏≤‡∏•‡πå‡∏° ‡∏ô‡∏≤‡∏¢‡∏ö‡∏∏‡∏ç‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡πå ‡∏°‡∏≤‡∏•‡∏≤‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå (Messenger)",
    "‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏£‡∏£‡∏ì ‡∏≠‡∏¥‡∏ô‡∏ô‡∏±‡∏ô‡∏ä‡∏±‡∏¢ (CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏∏ ‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏©‡πå ‡∏†‡∏≤‡∏©‡∏µ‡∏î‡∏≤ (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏Å ‡∏ô‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏ä‡∏±‡∏¢ ‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡∏£‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏ß‡∏ì‡∏µ‡∏¢‡πå ‡πÄ‡∏û‡πá‡∏ä‡∏£‡∏Ñ‡∏£‡∏∏‡∏ò (Senior Customs Broker Executive - Export)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ê‡∏≤‡∏ô‡∏¥‡∏ï‡∏≤ ‡∏Å‡∏π‡∏î‡∏≠‡∏±‡πâ‡∏ß (Assistant Billing Manager)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏®‡∏°‡∏±‡∏¢ ‡∏®‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå (Billing Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏ö‡πÄ‡∏ä‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡∏≤ ‡∏Ñ‡∏á‡πÑ‡∏ó‡∏¢ (CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏¥‡πä‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏£‡∏£‡∏ì‡∏û‡∏£ ‡∏à‡∏£‡∏π‡∏ç‡∏£‡∏±‡∏ï‡∏ô‡πå (Senior Billing Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πà‡∏≤‡∏¢ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏∏‡πà‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏ô ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏¥‡∏•‡∏Ñ‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏°‡∏ú‡∏Å‡∏≤ ‡∏õ‡∏ß‡∏á‡∏á‡∏≤‡∏° (Finance Executive - Payable)",
    "‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏≠ ‡∏ô‡∏≤‡∏¢‡∏ò‡∏ß‡∏±‡∏ä‡∏ä‡∏±‡∏¢ ‡∏†‡∏≤‡∏ô‡∏∏‡∏û‡∏±‡∏ô‡∏ò‡πå (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏Ü ‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏™‡∏∏‡∏Ç‡∏•‡∏¥‡πâ‡∏° (Shipping Executive)"
  ],
  p5: [
    "‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ú‡∏Å‡∏≤‡∏ß‡∏î‡∏µ ‡πÇ‡∏Å‡∏®‡∏¥‡∏£‡∏¥ (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡∏°‡∏µ‡πà‡∏¢‡∏ß ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏µ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏û‡∏≤ (Senior Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠‡πä‡∏ï ‡∏ô‡∏≤‡∏¢‡∏ß‡∏±‡∏ä‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏î‡∏∏‡∏ô‡∏≤ (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ô‡πâ‡∏≠‡∏á ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏é‡∏ê‡πå‡∏Å‡∏≤‡∏ô‡∏î‡∏≤ ‡∏û‡∏≤‡πÅ‡∏Å‡πâ‡∏ß (CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡∏´‡∏ô‡∏∏‡πà‡∏° ‡∏ô‡∏≤‡∏¢‡∏ô‡∏±‡∏ó‡∏ò‡∏µ ‡∏ö‡∏∏‡∏ç‡∏õ‡∏≤‡∏ô (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏à‡πã‡∏≤ ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏à‡∏∏‡∏ë‡∏≤‡∏°‡∏≤‡∏® ‡πÄ‡∏≠‡∏¥‡∏ö‡∏™‡∏≥‡πÇ‡∏£‡∏á (Customs Broker Executive - Import)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏¢‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏ô‡∏Å‡∏ß‡∏£‡∏£‡∏ì ‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå (Customs Broker Executive - Export)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡πã ‡∏ô‡∏≤‡∏¢‡∏à‡∏¥‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏Ñ‡∏π‡∏´‡∏∞‡∏°‡∏ì‡∏µ (Safety Manager)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡∏• ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏µ‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏®‡∏¥‡∏£‡∏¥‡∏©‡∏≤ (Billing Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏•‡∏¥‡∏ô ‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏ò‡∏¥‡∏û‡∏à‡∏ô‡πå ‡∏™‡∏≤‡∏°‡∏á‡∏≤‡∏°‡∏ô‡∏∏ (Messenger)",
    "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏ê‡∏ß‡∏£‡∏£‡∏ì ‡∏™‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (Finance Executive - Payable)",
    "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠‡πä‡∏ï ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏¥‡∏ï‡∏¢‡∏≤ ‡πÑ‡∏ï‡∏£‡∏û‡∏£‡∏° (Assistant Customs Broker Manager)",
    "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏≠‡∏ô ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏≠‡∏ô ‡πÇ‡∏Ñ‡∏ô‡∏à‡∏ß‡∏á (Maid)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏™‡∏Å ‡∏ô‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏ß‡∏±‡∏ä ‡πÄ‡∏û‡πá‡∏ä‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏Å ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏≤ ‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏™‡∏≤ (CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡πá‡∏î ‡∏ô‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏î‡∏∏‡∏ô‡∏≤ (Transportation Maintenance Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö‡∏ß‡πå ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏ê‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡∏ö‡∏∂‡∏Å‡∏ô‡∏±‡∏ô‡∏ï‡∏≤ (Billing Executive)",
    "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡∏î ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏£‡∏µ‡∏õ‡∏£‡∏∞‡∏†‡∏≤ ‡∏™‡∏≤‡∏£‡∏µ‡∏ö‡∏∏‡∏ï‡∏£ (Senior CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏£‡∏™‡∏∏‡∏†‡∏≤ ‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏£‡∏´‡∏° (CS Executive - Transportation)",
    "‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏∏‡πã‡∏° ‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏•‡∏¥‡∏©‡∏≤ ‡∏™‡∏°‡∏≠‡πà‡∏≠‡∏ô (Assistant Transportation Manager)"
  ]
};

// state
const completed = new Set();
const resultsAll = []; // {prizeId, prizeName, amount, winner}

// UI refs
const prizeSelect = document.getElementById("prizeSelect");
const drawBtn = document.getElementById("drawBtn");
const stagePills = document.getElementById("stagePills");

const animationBox = document.getElementById("animationBox");
const countdownEl = document.getElementById("countdown");
const spinTextEl = document.getElementById("spinText");

const bigWinnerBox = document.getElementById("bigWinnerBox");
const bigTitle = document.getElementById("bigTitle");
const bigCard = document.getElementById("bigCard");

const batchResults = document.getElementById("batchResults");
const batchTitle = document.getElementById("batchTitle");
const batchList = document.getElementById("batchList");

const finalSummary = document.getElementById("finalSummary");
const finalContent = document.getElementById("finalContent");
const actions = document.getElementById("actions");
const printBtn = document.getElementById("printBtn");
const exportBtn = document.getElementById("exportBtn");

const remainNote = document.getElementById("remainNote");

function updateRemain(){
  remainNote.textContent = `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${pool.length} ‡∏Ñ‡∏ô`;
}

function renderSelect(){
  prizeSelect.innerHTML = "";
  const available = prizes.filter(p => !completed.has(p.id));
  if(available.length === 0){
    const opt = document.createElement("option");
    opt.textContent = "‡∏à‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß";
    opt.value = "";
    prizeSelect.appendChild(opt);
    prizeSelect.disabled = true;
    drawBtn.disabled = true;
    return;
  }
  available.forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p.id;
    opt.textContent = p.label;
    prizeSelect.appendChild(opt);
  });
  prizeSelect.disabled = false;
  drawBtn.disabled = false;
}

function renderPills(){
  stagePills.innerHTML = "";
  prizes.forEach(p=>{
    const div = document.createElement("div");
    div.className = "pill" + (completed.has(p.id) ? " done" : "");
    if(!completed.has(p.id) && prizeSelect.value === p.id) div.classList.add("active");
    div.textContent = p.label;
    stagePills.appendChild(div);
  });
}

function medal(rank){
  if(rank===1) return "ü•á";
  if(rank===2) return "ü•à";
  if(rank===3) return "ü•â";
  return "üèÜ";
}

function removeFromPool(name){
  const idx = pool.indexOf(name);
  if(idx !== -1) pool.splice(idx, 1);
}

function getLockedWinners(prize){
  const list = LOCKED_RESULTS[prize.id] || [];
  return list.slice(0, prize.count);
}

function startCountdownAndReveal(prize){
  bigWinnerBox.style.display = "none";
  batchResults.style.display = "none";
  finalSummary.style.display = "none";

  drawBtn.disabled = true;
  prizeSelect.disabled = true;

  animationBox.style.display = "flex";
  animationBox.classList.add("spinner");

  const spinInterval = setInterval(()=>{
    const randomEmp = pool.length ? pool[Math.floor(Math.random() * pool.length)] : "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°...";
    spinTextEl.innerHTML = `üéÅ ${prize.prizeName} ‚Ä¢ ${prize.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>üéâ ${randomEmp}`;
  }, 120);

  let remaining = 10;
  countdownEl.textContent = remaining;

  const countdownTimer = setInterval(()=>{
    remaining--;
    if(remaining >= 1){
      countdownEl.textContent = remaining;
      return;
    }
    clearInterval(countdownTimer);
    clearInterval(spinInterval);
    animationBox.classList.remove("spinner");
    revealLockedWinners(prize);
  }, 1000);
}

function revealLockedWinners(prize){
  const lockedWinners = getLockedWinners(prize);

  if(completed.has(prize.id)){
    alert("‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß");
    prizeSelect.disabled = false;
    drawBtn.disabled = false;
    return;
  }

  if(prize.mode === "single"){
    const winner = lockedWinners[0] || "-";
    resultsAll.push({ prizeId:prize.id, prizeName:prize.prizeName, amount:prize.amount, winner });
    removeFromPool(winner);

    bigTitle.textContent = `${medal(prize.rank)} ${prize.prizeName} (${prize.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó)`;
    bigCard.innerHTML = `
      <div class="big-title">${prize.prizeName}</div>
      <div class="big-amount">${prize.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
      <div class="big-name">üéâ ${winner}</div>
    `;
    bigWinnerBox.style.display = "block";
  } else {
    batchTitle.textContent = `üìã ${prize.prizeName} (${prize.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${prize.count} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•`;
    batchList.innerHTML = "";

    lockedWinners.forEach(winner=>{
      resultsAll.push({ prizeId:prize.id, prizeName:prize.prizeName, amount:prize.amount, winner });
      removeFromPool(winner);

      const item = document.createElement("li");
      item.className = "batch-item";
      item.textContent = winner;
      batchList.appendChild(item);
    });
    batchResults.style.display = "block";
  }

  completed.add(prize.id);
  updateRemain();

  renderSelect();
  renderPills();

  if(completed.size === prizes.length){
    showFinalSummary();
    actions.style.display = "flex";
  }else{
    prizeSelect.disabled = false;
    drawBtn.disabled = false;
  }
}

function showFinalSummary(){
  const order = ["p1","p2","p3","p4","p5"];
  const grouped = {};
  order.forEach(id => grouped[id] = []);
  resultsAll.forEach(r => grouped[r.prizeId].push(r));

  const top3HTML = ["p1","p2","p3"].map((id, idx)=>{
    const p = prizes.find(x=>x.id===id);
    const r = grouped[id][0];
    const w = r ? r.winner : "-";
    return `
      <div class="top3-card">
        <div class="top3-rank">${medal(idx+1)} ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${idx+1}</div>
        <div class="top3-prize">${p.prizeName}</div>
        <div class="top3-amount">${p.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
        <div class="top3-winner">üéâ ${w}</div>
      </div>
    `;
  }).join("");

  let restHTML = `<div class="final-rest">`;
  ["p4","p5"].forEach(id=>{
    const p = prizes.find(x=>x.id===id);
    restHTML += `<h4>${p.prizeName} (${p.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${p.count} ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h4>`;
    restHTML += `<ul>`;
    grouped[id].forEach(r=>{
      restHTML += `<li>${p.prizeName} (${p.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó) : ${r.winner}</li>`;
    });
    restHTML += `</ul>`;
  });
  restHTML += `</div>`;

  finalContent.innerHTML = `
    <div class="final-top3">${top3HTML}</div>
    ${restHTML}
  `;
  finalSummary.style.display = "block";
}

function exportCSV(){
  const headers = ["Prize","Amount","Winner"];
  const lines = [headers.join(",")];
  const order = ["p1","p2","p3","p4","p5"];

  order.forEach(id=>{
    resultsAll.filter(r=>r.prizeId===id).forEach(r=>{
      lines.push(`"${r.prizeName}","${r.amount}","${r.winner.replaceAll('"','""')}"`);
    });
  });

  const csv = "\uFEFF" + lines.join("\n");
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "lucky_draw_results.csv";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// events
drawBtn.onclick = () => {
  const id = prizeSelect.value;
  if(!id) return;
  const prize = prizes.find(p=>p.id===id);
  if(!prize) return;
  startCountdownAndReveal(prize);
};
prizeSelect.onchange = renderPills;

printBtn.onclick = () => window.print();
exportBtn.onclick = exportCSV;

// init
renderSelect();
renderPills();
updateRemain();
animationBox.style.display = "none";
</script>
</body>
</html>
